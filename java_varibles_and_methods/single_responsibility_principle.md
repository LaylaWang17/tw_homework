# 理解单一职责原则

单一职责原则就是让一个方法 / 类 / 文件只干一件事。

（查了很多相关的资料，都是从类或接口的角度来讲的，不过从我的理解来说，这个职责不仅仅针对这两个维度）

从自己写思沃影院的体会来讲讲理解。

### 文件的单一职责原则

首先这个项目需要完成一个思沃影院的网页，提供查询电影信息的功能。项目包含了html（即网页布局）、css（样式与布局）、js（业务与展示逻辑）三部分工作。

实际上我们都知道html可以通过`<style>`标签和`<script>`标签之间将css和js部分的代码写进html里，但是对于一个内容较多且具有较为复杂的逻辑的网页来说，其html、css、js部分的代码都可能达到上百行（也许更多），因此这种方式会致使整个html体量庞大、难以维护。

因此，更好的做法是通过外部引用来添加css和js，做到html文件、css文件、js文件只负责其本身需要负责的事情。

同样的，对css文件来说，当网页内容较多时，css代码也是非常多的，如果把整个网页的css全部写在一个文件里会给调试与后续维护工作带来不必要的麻烦。

例如思沃影院这个项目包含了主页和详情页两个网页，这两个网页中有一部分元素实际上是相同的，如果能够把相同部分的css提取出来作为单独的css文件，不仅可以减少重复代码，还方面后续样式的调整。因此我们当时提取了一个`basic.css`文件控制基础样式、一个`navigation.css`文件控制两个网页的导航栏样式、一个`movie_card.css`文件控制电影卡片的样式，而主页和详情页主要的css样式文件仅控制其整体布局和其余不重复的元素。

对于js代码也是同样的道理，js是对项目业务逻辑与展示逻辑的实现，这两部分工作如果能做到低耦合会大大增添代码的可读性、便于维护。

同样以思沃影院这个项目为例，在最初的设计时我们将js部分划分成了数据处理、底层服务、业务逻辑、和页面渲染这四个部分，因此我们写了4个js文件来分别实现各部分的功能，实际实现的过程中我们也发现这四个部分实际上的耦合程度是非常低的，在业务逻辑部分分别调用其他部分相关方法即可实现整体的功能。而数据处理、底层服务、和页面渲染这几部分的方法也是可以在主页的业务逻辑和详情页的业务逻辑里复用的。

### 类的单一职责原则

引用一个例子，比如一个创建一个手机类，需要它具有拨通电话、通话、结束通话三个方法，那直观的写法当然是

```javascript
class Phone {
  dial(phoneNuber) {}
  chat() {}
  hangUp() {}
}
```

这种写法的问题在于将建立通信、数据传送这两件事混在了一起，因此可能更好的做法是分成两个类来实现

```javascript
class ConnectionManager {
  dial(phoneNumber) {}
  hangUp() {}
}

class DataTransfer {
  chat() {}
}
```

写思沃影院时我们虽然没有使用到面向对象的思想，但是如果现在让我来重构我的代码的话，我会考虑这么划分：

- 一个`Load`类用于加载数据
- 一个`CallApi`类，包含调用不同api的方法
- 一个`Search`类，包含根据不同分类、或关键词等信息筛选电影的方法

### 方法的单一职责原则

这个说起来就比较简单了，比如在思沃影院项目的`view.js`中我们写了很多方法，比如

- `renderGuideItemActive()`

- `renderMovieCard()`

- `renderMovieDetials()`

- `renderMovieComments()`

  …

每个方法只负责页面一个特定元素的渲染、互不影响，当页面元素结构发生改变时，也只需要修改对应元素的渲染方法。

遵循这样的原则使我们在开发的时候无论是面对自己还是小伙伴写的代码都可以非常快速的定位和修复bug，对提高开发效率也是非常有帮助的。

### 总结

那么就总结一下单一职责原则的好处：

- 简化的代码的复杂度
- 提高了代码的可读性
- 提高了代码的可维护性
- 降低了变更的风险